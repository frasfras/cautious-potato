<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haunted Tower</title>
    <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #1a0033, #0d001a);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Creepster', cursive;
            overflow: hidden;
        }
        @import url('https://fonts.googleapis.com/css2?family=Creepster&display=swap');
        
        #gameCanvas {
            border: 3px solid #4a0080;
            box-shadow: 0 0 30px #6600cc, inset 0 0 20px rgba(0,0,0,0.5);
            cursor: crosshair;
        }
        
        #ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff6600;
            text-align: center;
            text-shadow: 0 0 10px #ff0000, 2px 2px 4px #000;
            font-size: 24px;
            z-index: 10;
            pointer-events: none;
        }
        
        #gameOver {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            border: 4px solid #ff6600;
            padding: 30px;
            text-align: center;
            color: #ff6600;
            font-size: 28px;
            z-index: 20;
            box-shadow: 0 0 40px #ff0000;
        }
        
        button {
            background: #4a0080;
            color: #ff6600;
            border: 2px solid #ff6600;
            padding: 10px 30px;
            font-size: 20px;
            font-family: 'Creepster', cursive;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #6600cc;
            box-shadow: 0 0 20px #ff6600;
        }
    </style>
    
</head>
<body>
   
    <div id="ui"> <img src="ghostmobile.jpeg" height="80" alt="Background" style="display:block;" />
        <div>Score: <span id="score">0</span></div>
        <div style="font-size: 16px; margin-top: 5px;">Height: <span id="height">0</span>m</div>
    </div>
    
    <div id="gameOver">
        <div>THE TOWER HAS FALLEN!</div>
        <div style="font-size: 20px; margin-top: 10px;">Final Score: <span id="finalScore">0</span></div>
        <button onclick="restartGame()">RISE AGAIN</button>
    </div>
    
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <script>
        let stage, canvas;
        let blocks = [];
        let currentBlock = null;
        let baseBlock;
        let score = 0;
        let gameActive = true;
        let fogParticles = [];
        let ghosts = [];
        let groundY = 550;
        
        // Physics settings
        const GRAVITY = 0.5;
        const FRICTION = 0.98;
        
        // Block types
        const blockTypes = [
            { width: 100, height: 30, color: '#663399', label: 'Coffin' },
            { width: 80, height: 40, color: '#4a0080', label: 'Tombstone' },
            { width: 120, height: 25, color: '#8b4513', label: 'Bone' },
            { width: 90, height: 35, color: '#2d5016', label: 'Witch Plank' }
        ];

        function init() {
            canvas = document.getElementById('gameCanvas');
            stage = new createjs.Stage(canvas);
            createjs.Ticker.framerate = 60;
            createjs.Ticker.addEventListener('tick', tick);
            
            // Create spooky background
            createBackground();
            
            // Create fog
            for (let i = 0; i < 30; i++) {
                createFogParticle();
            }
            
            // Create base
            createBase();
            
            // Create first block
            spawnBlock();
            
            // Add ghost that occasionally appears
            setInterval(spawnGhost, 8000);
            
            // Mouse events
            canvas.addEventListener('click', dropBlock);
            canvas.addEventListener('mousemove', moveBlock);
        }
        
        function createBackground() {
            const bg = new createjs.Shape();
            bg.graphics.beginLinearGradientFill(['#1a0033', '#2d0052'], [0, 1], 0, 0, 0, 600);
            bg.graphics.drawRect(0, 0, 800, 600);
            stage.addChild(bg);
            
            // Moon
            const moon = new createjs.Shape();
            moon.graphics.beginRadialGradientFill(['#ffffcc', '#ffff99', '#666666'], [0, 0.5, 1], 0, 0, 0, 0, 0, 40);
            moon.graphics.drawCircle(650, 80, 40);
            stage.addChild(moon);
            
            //
            const bitmap = new createjs.Bitmap('ghostmobile.jpeg');
            bitmap.x = 100;
            bitmap.y = 100;
            stage.addChild(bitmap);
            // Graveyard ground
            const ground = new createjs.Shape();
            ground.graphics.beginFill('#1a1a1a');
            ground.graphics.drawRect(0, groundY, 800, 50);
            stage.addChild(ground);
        }
        
        function createFogParticle() {
            const fog = new createjs.Shape();
            const size = Math.random() * 60 + 40;
            fog.graphics.beginFill('rgba(200, 200, 220, 0.15)');
            fog.graphics.drawCircle(0, 0, size);
            fog.x = Math.random() * 800;
            fog.y = Math.random() * 600;
            fog.vx = (Math.random() - 0.5) * 0.5;
            fog.vy = (Math.random() - 0.5) * 0.3;
            fogParticles.push(fog);
            stage.addChild(fog);
        }
        
        function createBase() {
            baseBlock = new createjs.Shape();
            baseBlock.graphics.beginFill('#4a4a4a');
            baseBlock.graphics.drawRect(-150, -20, 300, 20);
            baseBlock.x = 400;
            baseBlock.y = groundY;
            baseBlock.width = 300;
            baseBlock.height = 20;
            stage.addChild(baseBlock);
        }
        
        function spawnBlock() {
            if (!gameActive) return;
            
            const type = blockTypes[Math.floor(Math.random() * blockTypes.length)];
            const block = new createjs.Container();
            
            const shape = new createjs.Shape();
            shape.graphics.beginFill(type.color);
            shape.graphics.drawRect(-type.width/2, -type.height/2, type.width, type.height);
            
            // Add spooky border
            shape.graphics.setStrokeStyle(2);
            shape.graphics.beginStroke('#000000');
            shape.graphics.drawRect(-type.width/2, -type.height/2, type.width, type.height);
            
            block.addChild(shape);
            
            block.x = 100;
            block.y = 100;
            block.width = type.width;
            block.height = type.height;
            block.vx = 0;
            block.vy = 0;
            block.rotation = 0;
            block.vr = 0;
            block.placed = false;
            block.cursed = Math.random() < 0.2; // 20% chance of cursed block
            
            if (block.cursed) {
                // Cursed blocks glow green
                shape.graphics.beginFill('rgba(0, 255, 0, 0.3)');
                shape.graphics.drawRect(-type.width/2, -type.height/2, type.width, type.height);
            }
            
            currentBlock = block;
            stage.addChild(block);
        }
        
        function moveBlock(e) {
            if (currentBlock && !currentBlock.placed) {
                const rect = canvas.getBoundingClientRect();
                currentBlock.x = e.clientX - rect.left;
            }
        }
        
        function dropBlock() {
            if (!currentBlock || currentBlock.placed || !gameActive) return;
            
            currentBlock.placed = true;
            currentBlock.vy = 2;
            blocks.push(currentBlock);
            
            setTimeout(() => {
                if (gameActive) spawnBlock();
            }, 500);
        }
        
        function spawnGhost() {
            if (!gameActive) return;
            
            const ghost = new createjs.Container();
            const shape = new createjs.Shape();
            
            // Ghost body
            shape.graphics.beginFill('rgba(255, 255, 255, 0.4)');
            shape.graphics.drawCircle(0, 0, 20);
            shape.graphics.drawRect(-20, 0, 40, 30);
            
            // Ghost tail
            for (let i = 0; i < 4; i++) {
                shape.graphics.drawCircle(-15 + i * 10, 30, 7);
            }
            
            ghost.addChild(shape);
            ghost.x = Math.random() < 0.5 ? -30 : 830;
            ghost.y = Math.random() * 300 + 100;
            ghost.vx = ghost.x < 0 ? 2 : -2;
            
            ghosts.push(ghost);
            stage.addChild(ghost);
        }
        
        function checkCollision(block1, block2) {
            const dx = block1.x - block2.x;
            const dy = block1.y - block2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            return distance < (block1.width + block2.width) / 2;
        }
        
        function checkStability() {
            let stable = true;
            for (let block of blocks) {
                if (block.y > groundY + 10 || block.x < -50 || block.x > 850) {
                    stable = false;
                    break;
                }
            }
            return stable;
        }
        
        function endGame() {
            gameActive = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOver').style.display = 'block';
            
            // Make blocks fall
            blocks.forEach(block => {
                block.vx = (Math.random() - 0.5) * 10;
                block.vy = -5;
                block.vr = (Math.random() - 0.5) * 20;
            });
        }
        
        function tick(event) {
            // Update fog
            fogParticles.forEach(fog => {
                fog.x += fog.vx;
                fog.y += fog.vy;
                
                if (fog.x < -50) fog.x = 850;
                if (fog.x > 850) fog.x = -50;
                if (fog.y < -50) fog.y = 650;
                if (fog.y > 650) fog.y = -50;
            });
            
            // Update ghosts
            for (let i = ghosts.length - 1; i >= 0; i--) {
                const ghost = ghosts[i];
                ghost.x += ghost.vx;
                ghost.alpha = 0.3 + Math.sin(Date.now() * 0.005) * 0.2;
                
                // Ghost interference with tower
                if (gameActive) {
                    blocks.forEach(block => {
                        if (block.placed && checkCollision(ghost, block)) {
                            block.vx += ghost.vx * 0.3;
                        }
                    });
                }
                
                if (ghost.x < -50 || ghost.x > 850) {
                    stage.removeChild(ghost);
                    ghosts.splice(i, 1);
                }
            }
            
            // Update blocks
            blocks.forEach((block, index) => {
                if (!block.placed) return;
                
                // Apply gravity
                block.vy += GRAVITY;
                
                // Apply friction
                block.vx *= FRICTION;
                block.vy *= 0.99;
                block.vr *= 0.95;
                
                // Update position
                block.x += block.vx;
                block.y += block.vy;
                block.rotation += block.vr;
                
                // Cursed blocks wobble
                if (block.cursed && Math.abs(block.vy) < 1) {
                    block.x += Math.sin(Date.now() * 0.01 + index) * 0.5;
                }
                
                // Check collision with ground
                if (block.y >= groundY - block.height/2) {
                    block.y = groundY - block.height/2;
                    block.vy *= -0.3;
                    block.vx *= 0.8;
                    if (Math.abs(block.vy) < 1) block.vy = 0;
                }
                
                // Check collision with base
                if (block.y + block.height/2 > baseBlock.y - baseBlock.height &&
                    block.y - block.height/2 < baseBlock.y &&
                    block.x > baseBlock.x - baseBlock.width/2 &&
                    block.x < baseBlock.x + baseBlock.width/2) {
                    block.y = baseBlock.y - baseBlock.height - block.height/2;
                    block.vy *= -0.3;
                    if (Math.abs(block.vy) < 1) {
                        block.vy = 0;
                        score += 10;
                        document.getElementById('score').textContent = score;
                    }
                }
                
                // Check collision with other blocks
                blocks.forEach((other, otherIndex) => {
                    if (other === block || !other.placed) return;
                    
                    if (checkCollision(block, other)) {
                        const dx = block.x - other.x;
                        const dy = block.y - other.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        const minDist = (block.width + other.width) / 2;
                        
                        if (distance < minDist) {
                            const angle = Math.atan2(dy, dx);
                            const targetX = other.x + Math.cos(angle) * minDist;
                            const targetY = other.y + Math.sin(angle) * minDist;
                            
                            block.x = targetX;
                            block.y = targetY;
                            
                            block.vx *= 0.8;
                            block.vy *= 0.8;
                        }
                    }
                });
            });
            
            // Update height
            let maxHeight = 0;
            blocks.forEach(block => {
                if (block.placed) {
                    const height = groundY - block.y;
                    if (height > maxHeight) maxHeight = height;
                }
            });
            document.getElementById('height').textContent = Math.floor(maxHeight / 10);
            
            // Check stability
            if (gameActive && blocks.length > 0 && !checkStability()) {
                endGame();
            }
            
            stage.update();
        }
        
        function restartGame() {
            // Clear everything
            blocks.forEach(block => stage.removeChild(block));
            ghosts.forEach(ghost => stage.removeChild(ghost));
            blocks = [];
            ghosts = [];
            score = 0;
            gameActive = true;
            
            document.getElementById('score').textContent = '0';
            document.getElementById('height').textContent = '0';
            document.getElementById('gameOver').style.display = 'none';
            
            if (currentBlock) {
                stage.removeChild(currentBlock);
            }
            
            spawnBlock();
        }
        
        window.onload = init;
    </script>
    <!-- <div id="root"></div> -->
      <img src="ghostmobile.jpeg" height="80" alt="Background" style="display:block;" /> 
</body>
</html>